<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<meta name="author" content="Stéphane Nicoll, Dave Syer, Madhura Bhave">
<title>Spring Initializr Reference Guide</title>
<link rel="stylesheet" href="css/site.css">
<script src="js/setup.js"></script><script defer src="js/site.js"></script>

</head>
<body class="book toc2 toc-left"><div id="banner-container" class="container" role="banner">
  <div id="banner" class="contained" role="banner">
    <div id="switch-theme">
      <input type="checkbox" id="switch-theme-checkbox" />
      <label for="switch-theme-checkbox">Dark Theme</label>
    </div>
  </div>
</div>
<div id="tocbar-container" class="container" role="navigation">
  <div id="tocbar" class="contained" role="navigation">
    <button id="toggle-toc"></button>
  </div>
</div>
<div id="main-container" class="container">
  <div id="main" class="contained">
    <div id="doc" class="doc">
<div id="header">
<h1>Spring Initializr Reference Guide</h1>
<div class="details">
<span id="author" class="author">Stéphane Nicoll</span><br>
<span id="author2" class="author">Dave Syer</span><br>
<span id="author3" class="author">Madhura Bhave</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#initializr-documentation">Spring Initializr Documentation</a>
<ul class="sectlevel1">
<li><a href="#initializr-documentation-about">1. About the documentation</a></li>
<li><a href="#initializr-documentation-getting-help">2. Getting help</a></li>
</ul>
</li>
<li><a href="#introduction">Introduction</a>
<ul class="sectlevel1">
<li><a href="#project-metadata">3. Project Metadata</a></li>
<li><a href="#web-endpoints">4. Web Endpoints</a></li>
<li><a href="#supported-clients">5. Supported Clients</a></li>
</ul>
</li>
<li><a href="#configuration-guide">Configuration Guide</a>
<ul class="sectlevel1">
<li><a href="#project-generation-overview">6. Project Generation Overview</a>
<ul class="sectlevel2">
<li><a href="#initializr-generator">6.1. Initializr Generator</a>
<ul class="sectlevel3">
<li><a href="#initializr-generator-project">6.1.1. Project Generator</a></li>
<li><a href="#initializr-generator-project-lifecycle">6.1.2. Project Generation Lifecycle</a></li>
<li><a href="#initializr-generator-abstractions">6.1.3. Project Abstractions</a></li>
</ul>
</li>
<li><a href="#initializr-generator-spring">6.2. Conventions for Spring Boot</a>
<ul class="sectlevel3">
<li><a href="#initializr-generator-spring-requirements">6.2.1. Requirements</a></li>
<li><a href="#initializr-generator-spring-facets">6.2.2. Supported facets</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#create-instance">7. Creating your own instance</a>
<ul class="sectlevel2">
<li><a href="#create-instance-basic-settings">7.1. Configuring basic settings</a></li>
<li><a href="#create-instance-text-only-settings">7.2. Configuring text-only settings</a></li>
<li><a href="#create-instance-platform-versions">7.3. Configuring available platform versions</a></li>
<li><a href="#create-instance-types">7.4. Configuring available project types</a></li>
<li><a href="#create-instance-dependencies">7.5. Configuring dependencies</a>
<ul class="sectlevel3">
<li><a href="#dependencies-compatibility-range">7.5.1. Compatibility Range</a></li>
<li><a href="#dependencies-repository">7.5.2. Repository</a></li>
</ul>
</li>
<li><a href="#create-instance-boms">7.6. Configuring Bill of Materials</a>
<ul class="sectlevel3">
<li><a href="#dependencies-mappings">7.6.1. Map coordinates according to the platform version</a></li>
<li><a href="#dependencies-alias">7.6.2. Aliases</a></li>
<li><a href="#dependencies-facet">7.6.3. Facets</a></li>
<li><a href="#create-instance-dependencies-link">7.6.4. Links</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#configuration-access">8. Generating a Project using the Web Endpoints</a></li>
<li><a href="#configuration-howto">9. &#8216;How-to&#8217; guides</a>
<ul class="sectlevel2">
<li><a href="#howto-add-a-new-dependency">9.1. Add a new dependency</a></li>
<li><a href="#howto-override-a-version">9.2. Override the version of a dependency</a></li>
<li><a href="#howto-link-platform-version">9.3. Link a version of the platform to a version of your dependency</a></li>
<li><a href="#howto-add-snapshot-repository">9.4. Configure a snapshot repository</a></li>
<li><a href="#howto-configure-custom-parent-pom">9.5. Configure a custom parent POM</a></li>
<li><a href="#howto-dependency-starter-flag">9.6. Make sure a regular dependency brings the base starter</a></li>
<li><a href="#howto-group-share-settings">9.7. Share common dependency settings in a group</a></li>
<li><a href="#howto-kotlin-version-mapping">9.8. Configure Kotlin version mapping</a></li>
<li><a href="#howto-platform-version-format">9.9. Configure platform version format</a></li>
</ul>
</li>
<li><a href="#create-instance-advanced-config">10. Advanced configuration</a>
<ul class="sectlevel2">
<li><a href="#create-instance-advanced-config-caching">10.1. Caching configuration</a></li>
<li><a href="#create-instance-advanced-config-custom-project-request">10.2. Bind to custom project request</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#api-guide">API Guide</a>
<ul class="sectlevel1">
<li><a href="#metadata-format">11. Metadata Format</a>
<ul class="sectlevel2">
<li><a href="#service-capabilities">11.1. Service Capabilities</a>
<ul class="sectlevel3">
<li><a href="#project-dependencies">11.1.1. Project dependencies</a></li>
<li><a href="#project-types">11.1.2. Project types</a></li>
<li><a href="#packaging">11.1.3. Packaging</a></li>
<li><a href="#java-version">11.1.4. Java version</a></li>
<li><a href="#languages">11.1.5. Languages</a></li>
<li><a href="#platform-versions">11.1.6. Platform versions</a></li>
</ul>
</li>
<li><a href="#defaults">11.2. Defaults</a></li>
</ul>
</li>
<li><a href="#using-the-stubs">12. Using the Stubs</a>
<ul class="sectlevel2">
<li><a href="#using-wiremock-with-spring-boot">12.1. Using WireMock with Spring Boot</a>
<ul class="sectlevel3">
<li><a href="#loading-stubs-from-the-classpath">12.1.1. Loading Stubs from the Classpath</a></li>
<li><a href="#using-the-stub-runner">12.1.2. Using the Stub Runner</a></li>
</ul>
</li>
<li><a href="#names-and-paths-of-stubs">12.2. Names and Paths of Stubs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<h1 id="initializr-documentation" class="sect0"><a class="anchor" href="#initializr-documentation"></a>Spring Initializr Documentation</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>This section provides a brief overview of the Spring Initializr reference documentation:
think of it as map for the rest of the document. Some sections are targeted to a specific
audience so this reference guide is not meant to be read in a linear fashion.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Spring Initializr provides an extensible API to generate JVM-based projects, and to
inspect the metadata used to generate projects, for instance to list the available
dependencies and versions.</p>
</div>
<div class="paragraph">
<p>The documentation is roughly divided into three parts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#introduction">Introduction</a>: This section provides an introduction to the library and how one
can interact with the service to generate a project.</p>
</li>
<li>
<p><a href="#configuration-guide">Configuration Guide</a>: This section covers creating your own
instance of Spring Initializr using the jars as libraries in your own app.</p>
</li>
<li>
<p><a href="#api-guide">API Guide</a>: This section covers the API used for project generation.
The API can be used standalone or embedded in other tools (e.g. it is used in major IDEs
such as Spring Tool Suite, IntelliJ IDEA Ultimate, Netbeans and VSCode).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can easily create your own instance using Spring Initializr, by using the jars as
libraries in your own app. There is minimal code involved and the service has a very rich
configuration structure, allowing you to define not only the values of various project
attributes but also the list of dependencies and the constraints to apply to them. If that
sounds interesting, then <a href="#configuration-guide">Configuration Guide</a> has all the
details you need. You might only want to modify an existing instance of Spring Initializr,
e.g. to add a new dependency type, or update the version of an existing
one. For those and other simple and common use cases check out
<a href="#configuration-howto">&#8216;How-to&#8217; guides</a>.</p>
</div>
<div class="paragraph">
<p>Spring Initializr also provides an extensible API to generate JVM-based projects, and to
inspect the metadata used to generate projects, for instance to list the available
dependencies and versions. The API can be used standalone or embedded in other tools
(e.g. it is used in major IDEs such as Spring Tool Suite, IntelliJ IDEA Ultimate, Netbeans
and VSCode). These features are covered in <a href="#api-guide">API Guide</a>.</p>
</div>
<div class="sect1">
<h2 id="initializr-documentation-about"><a class="anchor" href="#initializr-documentation-about"></a>1. About the documentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Spring Initializr reference guide is available as
<a href="https://docs.spring.io/initializr/docs/0.22.0-SNAPSHOT/reference/html">html</a>. The
latest copy is available at <a href="https://docs.spring.io/initializr/docs/current/reference/html" class="bare">docs.spring.io/initializr/docs/current/reference/html</a>.</p>
</div>
<div class="paragraph">
<p>Copies of this document may be made for your own use and for
distribution to others, provided that you do not charge any fee for such copies and
further provided that each copy contains this Copyright Notice, whether distributed
in print or electronically.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="initializr-documentation-getting-help"><a class="anchor" href="#initializr-documentation-getting-help"></a>2. Getting help</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Having trouble with Spring Initializr, We&#8217;d like to help!</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ask a question on <a href="https://gitter.im/spring-io/initializr">Gitter</a>.</p>
</li>
<li>
<p>Report bugs with Spring Initializr at <a href="https://github.com/spring-io/initializr/issues" class="bare">github.com/spring-io/initializr/issues</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All of Spring Initializr is open source, including the documentation! If you
find problems with the docs; or if you just want to improve them, please
<a href="https://github.com/spring-io/initializr/tree/main">get involved</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<h1 id="introduction" class="sect0"><a class="anchor" href="#introduction"></a>Introduction</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>This is a gentle introduction to what Spring Initializr can do. You&#8217;ll find the various
ways you can interact with a Spring Initializr service and get a better insight at what
you can do with it.</p>
</div>
<div class="paragraph">
<p>The service allows you to generate JVM-based projects quickly. You can customize the
project to generate: the build system and packaging, the language, the packaging,
the coordinates, the platform version and, finally, the dependencies to add to the
project.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="project-metadata"><a class="anchor" href="#project-metadata"></a>3. Project Metadata</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Initializr exposes a number of endpoints that can be used to generate a JVM-based
project. You can easily <a href="#create-instance">create your own
instance</a> by providing the metadata of various core concepts.</p>
</div>
<div class="paragraph">
<p>Based on the metadata and a list of contributors, a
<a href="#initializr-generator-project">project generation engine</a> is
available to generate the actual project&#8217;s assets. The result of the generation could be
a directory with a project or any other content.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="web-endpoints"><a class="anchor" href="#web-endpoints"></a>4. Web Endpoints</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This library can be used in a web application to expose a number of endpoints that are
used to handle project generation. The main entry point for the service is its metadata
endpoint, available at the root of the context. It is used by various clients to determine
the available options and present them to the user, if possible.</p>
</div>
<div class="paragraph">
<p>The metadata endpoint also lists the type of projects that can be generated and how the
service can trigger them.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="supported-clients"><a class="anchor" href="#supported-clients"></a>5. Supported Clients</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Out-of-the-box, a custom instance handles command-line requests using <code>cURL</code> or <code>HTTPie</code>.
Spring Initializr is also supported in various IDEs, check the documentation of your
favourite IDE for more details.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring Initializr does not provide a Web UI to interact with the service.
</td>
</tr>
</table>
</div>
</div>
</div>
<h1 id="configuration-guide" class="sect0"><a class="anchor" href="#configuration-guide"></a>Configuration Guide</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>You can use Spring Initializr to create your own service that can generate JVM projects.
This section describes how you can create your own service and tune it for
your needs, and also how you can configure an existing service.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="project-generation-overview"><a class="anchor" href="#project-generation-overview"></a>6. Project Generation Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before getting into <a href="#create-instance">creating your own service</a>, let&#8217;s take a look at
the core concepts of project generation and how the library is structured to support them.</p>
</div>
<div class="paragraph">
<p>Initializr is split across several modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>initializr-actuator</code>: optional module to provide additional information and statistics
on project generation.</p>
</li>
<li>
<p><code>initializr-bom</code>: provides a Bill of Materials for easier dependency management in your
project.</p>
</li>
<li>
<p><code>initializr-docs</code>: documentation.</p>
</li>
<li>
<p><code>initializr-generator</code>: core project generation library.</p>
</li>
<li>
<p><code>initializr-generator-spring</code>: optional module defining the conventions for a typical
Spring Boot project. Can be reused or replaced by your own conventions.</p>
</li>
<li>
<p><code>initializr-generator-test</code>: test infrastructure for project generation.</p>
</li>
<li>
<p><code>initializr-metadata</code>: metadata infrastructure for various aspects of the project.</p>
</li>
<li>
<p><code>initializr-service-sample</code>: showcases a basic custom instance.</p>
</li>
<li>
<p><code>initializr-version-resolver</code>: optional module to extract version numbers from an
arbitrary POM.</p>
</li>
<li>
<p><code>initializr-web</code>: web endpoints for third party clients.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To understand concepts behind project generation, let&#8217;s take a look at
<code>initializr-generator</code> and <code>initializr-generator-spring</code> in a little more detail.</p>
</div>
<div class="sect2">
<h3 id="initializr-generator"><a class="anchor" href="#initializr-generator"></a>6.1. Initializr Generator</h3>
<div class="paragraph">
<p>The <code>initializr-generator</code> module contains the low-level infrastructure necessary to
generate JVM-based projects.</p>
</div>
<div class="sect3">
<h4 id="initializr-generator-project"><a class="anchor" href="#initializr-generator-project"></a>6.1.1. Project Generator</h4>
<div class="paragraph">
<p>The <code>ProjectGenerator</code> class is the main entry point for project generation. A
<code>ProjectGenerator</code> takes a <code>ProjectDescription</code> that defines a particular project to
generate as well as an implementation of <code>ProjectAssetGenerator</code> that is responsible to
generate assets based on available candidates.</p>
</div>
<div class="paragraph">
<p>A project is defined by <code>ProjectDescription</code> which consists of the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Basic coordinates such as <code>groupId</code>, <code>artifactId</code>, <code>name</code>, <code>description</code></p>
</li>
<li>
<p>The <code>BuildSystem</code> and <code>Packaging</code></p>
</li>
<li>
<p>The JVM <code>Language</code></p>
</li>
<li>
<p>The requested dependencies, indexed by ID</p>
</li>
<li>
<p>A platform <code>Version</code> used by the project. This can be used to tune available
dependencies according to the chosen generation.</p>
</li>
<li>
<p>The name of the <code>application</code></p>
</li>
<li>
<p>The root package name</p>
</li>
<li>
<p>The base directory for the project (if different from the root)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Project generation occurs in a dedicated application context (<code>ProjectGenerationContext</code>),
which means that for every project that is generated, the context only contains
configuration and components relevant to that particular project. Candidate components for
a <code>ProjectGenerationContext</code> are defined in <code>@ProjectGenerationConfiguration</code>-annotated
configuration classes. These configuration classes are imported automatically if they are
registered in <code>META-INF/spring.factories</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>io.spring.initializr.generator.project.ProjectGenerationConfiguration=\
com.example.acme.build.BuildProjectGenerationConfiguration,\
com.example.acme.code.SourceCodeProjectGenerationConfiguration</pre>
</div>
</div>
<div class="paragraph">
<p>Components that are added to the <code>ProjectGenerationContext</code> are generally made available
using conditions. Using conditions avoids exposing beans that have to check if they have
to do something and makes the declaration more idiomatic. Consider the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Bean
@ConditionalOnBuildSystem(GradleBuildSystem.ID)
@ConditionalOnPackaging(WarPackaging.ID)
public BuildCustomizer&lt;GradleBuild&gt; warPluginContributor() {
    return (build) -&gt; build.plugins().add("war");
}
</code></pre>
</div>
</div>
<div class="paragraph">
<p>This registers a component that can customize a Gradle build only if the project to
generate uses the "Gradle" <code>BuildSystem</code> and "war" <code>Packaging</code>. Check the
<code>io.spring.initializr.generator.condition</code> package for more conditions. You can create
custom conditions easily by inheriting from <code>ProjectGenerationCondition</code>.</p>
</div>
<div class="paragraph">
<p>You can only use such conditions on beans that have been loaded on the
<code>ProjectGenerationConfiguration</code> as they require a concrete <code>ProjectDescription</code> bean
to operate properly.</p>
</div>
<div class="paragraph">
<p>Project generation may also rely on infrastructure that is not specific to a particular
project configuration and is usually configured in the main <code>ApplicationContext</code> to avoid
registering it every time a new request comes in. A common use case is to set the main
<code>ApplicationContext</code> as the parent of the <code>ProjectGenerationContext</code>, as shown in the
following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public ProjectGenerator createProjectGenerator(ApplicationContext appContext) {
    return new ProjectGenerator((context) -&gt; {
        context.setParent(appContext);
        context.registerBean(SampleContributor.class, SampleContributor::new);
    });
}
</code></pre>
</div>
</div>
<div class="paragraph">
<p>This creates a new <code>ProjectGenerator</code> that can use any bean of the application, register
all contributors found in <code>META-INF/spring.factories</code> and also registers an additional
<code>ProjectContributor</code> programmatically.</p>
</div>
<div class="paragraph">
<p><code>ProjectContributor</code> is the highest level interface one can implement to contribute assets
to a a project. The <code>SampleContributor</code> registered above generates a <code>hello.txt</code> file at
the root of the project structure, as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class SampleContributor implements ProjectContributor {

    @Override
    public void contribute(Path projectRoot) throws IOException {
        Path file = Files.createFile(projectRoot.resolve("hello.txt"));
        try (PrintWriter writer = new PrintWriter(Files.newBufferedWriter(file))) {
            writer.println("Test");
        }
    }

}
</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="initializr-generator-project-lifecycle"><a class="anchor" href="#initializr-generator-project-lifecycle"></a>6.1.2. Project Generation Lifecycle</h4>
<div class="paragraph">
<p>When a <code>ProjectGenerator</code> is instructed to generate a project, the specified
<code>ProjectDescription</code> can be customized using available <code>ProjectDescriptionCustomizer</code>
beans and can be ordered using Spring&#8217;s <code>Ordered</code> interface. A <code>ProjectDescriptionDiff</code>
bean is available for extensions that wish to know if an attribute of the original
<code>ProjectDescription</code> was modified.</p>
</div>
<div class="paragraph">
<p>Once the description has been customized based on the available
<code>ProjectDescriptionCustomizer</code>s, the generator uses a <code>ProjectAssetGenerator</code> to
generate the project assets. The <code>initializr-generator</code> module provides a default
implementation of this interface (<code>DefaultProjectAssetGenerator</code>) that generates a
directory structure using available <code>ProjectContributor</code> beans.</p>
</div>
<div class="paragraph">
<p>While the default <code>ProjectAssetGenerator</code> uses the file system and invoke a particular set
of components, it is possible to use the same <code>ProjectGenerator</code> instance with a custom
implementation that focusses on something else entirely.</p>
</div>
</div>
<div class="sect3">
<h4 id="initializr-generator-abstractions"><a class="anchor" href="#initializr-generator-abstractions"></a>6.1.3. Project Abstractions</h4>
<div class="paragraph">
<p>This module also contains abstractions for various aspects of the project along with
some convenient implementations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A build system abstraction with Maven and Gradle implementations.</p>
</li>
<li>
<p>A language abstraction with Java, Groovy and Kotlin implementations, including a
<code>SourceCodeWriter</code> for each implementation.</p>
</li>
<li>
<p>A packaging abstraction with implementations for <code>jar</code> and <code>war</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Adding new implementations for these involves creating a <code>BuildSystemFactory</code>,
<code>LanguageFactory</code> and <code>PackagingFactory</code> and registering them in
<code>META-INF/spring.factories</code> under
<code>io.spring.initializr.generator.buildsystem.BuildSystemFactory</code>,
<code>io.spring.initializr.generator.language.LanguageFactory</code> and
<code>io.spring.initializr.generator.packaging.PackagingFactory</code> respectively.</p>
</div>
<div class="paragraph">
<p>A JVM project typically contains a build configuration for the project. The
<code>initializr-generator</code> module provides a model for <code>Build</code> with implementations for
<code>Maven</code> and <code>Gradle</code>. This model can be manipulated depending on the conventions. The
library also provides a <code>MavenBuildWriter</code> and <code>GradleBuildWriter</code> that can convert a
<code>Build</code> model to build file(s).</p>
</div>
<div class="paragraph">
<p>The next section about the <a href="#initializr-generator-spring"><code>initializr-generator-spring</code></a>
module showcases how the <code>Build</code> can be manipulated before the build file is written
using customizers.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="initializr-generator-spring"><a class="anchor" href="#initializr-generator-spring"></a>6.2. Conventions for Spring Boot</h3>
<div class="paragraph">
<p>This is an optional module that defines the conventions that we think will be useful for
any Spring Boot project. You can include this jar in your project if your service is meant
for generating Spring Boot projects.</p>
</div>
<div class="paragraph">
<p>In the <a href="#initializr-generator-project">Project Generator section</a>, we looked at how
<code>ProjectContributor</code>s can be used to contribute assets to a project. This module
contains concrete implementations of <code>ProjectContributor</code> along with the
<code>@ProjectGenerationConfiguration</code>s that configure them. For example, there is a
<code>MavenBuildProjectContributor</code> which contributes the files for a Maven build, such as
<code>pom.xml</code>. This contributor is registered as a bean in a <code>ProjectGenerationConfiguration</code>
which is conditional on the build system being Maven.</p>
</div>
<div class="paragraph">
<p>This module also introduces the concept of <code>BuildCustomizer</code>s. <code>BuildCustomizer</code>s are
used to customize a project&#8217;s <code>Build</code> and are ordered. For instance, if your service
requires you to add a certain plugin to the build, you can provide a <code>BuildCustomizer</code>
that adds the plugin and the customizer will be called according to the order specified on
it.</p>
</div>
<div class="sect3">
<h4 id="initializr-generator-spring-requirements"><a class="anchor" href="#initializr-generator-spring-requirements"></a>6.2.1. Requirements</h4>
<div class="paragraph">
<p>Contributors of this module expect the following beans to be available in the
<code>ProjectGenerationContext</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>InitializrMetadata</code> instance to use</p>
</li>
<li>
<p>Optionally, a <code>MetadataBuildItemResolver</code> that can resolve various build items (such as
dependencies and BOMs based on their id in the metadata</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you are using a parent context, it is advised to configure those there as you should
not register them every time a new project is generated:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An <code>IndentingWriterFactory</code> that represents the indenting strategy to use.</p>
</li>
<li>
<p>A <code>MustacheTemplateRenderer</code> using <code>classpath:/templates</code> as root location. Consider
registering such bean with a cache strategy to avoid resolving templates every time.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="initializr-generator-spring-facets"><a class="anchor" href="#initializr-generator-spring-facets"></a>6.2.2. Supported facets</h4>
<div class="paragraph">
<p>The following facets are handled:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>web</code>: used to drive the inclusion of a dependency with id <code>web</code> (defaulting to
<code>spring-boot-starter-web</code> if no dependency with that facet is present</p>
</li>
<li>
<p><code>jpa</code>: used to tag that this project uses JPA. When combined with Kotlin, this makes
sure to configure the appropriate plugin</p>
</li>
<li>
<p><code>json</code>: used to tag that this project depends on Jackson. When combined with Kotlin,
this makes sure to add the Kotlin-specific jackson module for better interoperability.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-instance"><a class="anchor" href="#create-instance"></a>7. Creating your own instance</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes how one can create a custom service.</p>
</div>
<div class="paragraph">
<p>The first step is to create a new project for your instance and add the following to
the build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.spring.initializr&lt;/groupId&gt;
        &lt;artifactId&gt;initializr-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.spring.initializr&lt;/groupId&gt;
        &lt;artifactId&gt;initializr-generator-spring&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;

&lt;dependencyManagement&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;io.spring.initializr&lt;/groupId&gt;
            &lt;artifactId&gt;initializr-bom&lt;/artifactId&gt;
            &lt;version&gt;0.22.0-SNAPSHOT&lt;/version&gt;
            &lt;type&gt;pom&lt;/type&gt;
            &lt;scope&gt;import&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or if you are using Gradle:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">implementation("org.springframework.boot:spring-boot-starter-web")
implementation("io.spring.initializr:initializr-web")
implementation("io.spring.initializr:initializr-generator-spring")

dependencyManagement {
  imports {
    mavenBom "io.spring.initializr:initializr-bom:0.22.0-SNAPSHOT"
  }
}
</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is assumed that the custom instance will be used to generate Spring Boot-based
projects using the conventions provided by the <code>initializr-generator-spring</code> module.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once you&#8217;ve started the application, you can hit <a href="http://localhost:8080" class="bare">localhost:8080</a>. You&#8217;ll get a json
document that describes the capabilities of the service. None of the select capabilities
will have values. In the rest of this section, we will configure those basic settings.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Most of the settings are configured via <code>application.properties</code> using the <code>initializr</code>
namespace. Because the configuration is highly hierarchical, we recommend using the yaml
format that is more readable for such structure. If you agree, go ahead and create an
<code>application.yml</code> in <code>src/main/resources</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="create-instance-basic-settings"><a class="anchor" href="#create-instance-basic-settings"></a>7.1. Configuring basic settings</h3>
<div class="paragraph">
<p>Most of the select capabilities are configured via a simple list-based structure where
each entry has an <code>id</code>, a <code>name</code> and whether that entry is the default or not. If no
<code>name</code> is provided, the <code>id</code> is used instead.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s configure the languages and the JVM generations we want to support:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  javaVersions:
    - id: 11
      default: false
    - id: 1.8
      default: true
  languages:
    - name: Java
      id: java
      default: true
    - name: Kotlin
      id: kotlin
      default: false</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you restart the application and refresh <a href="http://localhost:8080" class="bare">localhost:8080</a>, the language capability
now has the options and default values defined above.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The language identifiers defined there must have a corresponding <code>Language</code>
implementation. <code>java</code>, <code>kotlin</code> and <code>groovy</code> can be used out-of-the-box as
implementations for those are available in the core library itself.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The available packagings are also configurable that way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  packagings:
    - name: Jar
      id: jar
      default: true
    - name: War
      id: war
      default: false</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>Jar</code> and <code>War</code> packaging types are available out-of-the-box. For additional
packaging formats, you need to implement the <code>Packaging</code> abstraction and provide a
<code>PackagingFactory</code> that corresponds to it.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="create-instance-text-only-settings"><a class="anchor" href="#create-instance-text-only-settings"></a>7.2. Configuring text-only settings</h3>
<div class="paragraph">
<p>Text-only capabilities include <code>groupId</code>, <code>artifactId</code>, <code>name</code>, <code>description</code>, <code>version</code>
and <code>packageName</code>. Each capability has a default value if nothing is configured. The
defaults can be overridden as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  group-id:
    value: org.acme
  artifact-id:
    value: my-app</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-instance-platform-versions"><a class="anchor" href="#create-instance-platform-versions"></a>7.3. Configuring available platform versions</h3>
<div class="paragraph">
<p>You can configure the available platform versions the same way you configure other
capabilities.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the concept is reference to <code>bootVersions</code> as it predates the concept of platform
versions.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  bootVersions:
    - id: 2.4.0-SNAPSHOT
      name: 2.4.0 (SNAPSHOT)
      default: false
    - id: 2.3.3.BUILD-SNAPSHOT
      name: 2.3.3 (SNAPSHOT)
      default: false
    - id: 2.3.2.RELEASE
      name: 2.3.2
      default: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>The configuration above provides three versions, with <code>2.3.2</code> being used by default. In
practice though, you may want to upgrade the available platform versions without having
to redeploy the application every time. Implementing your own
<code>InitializrMetadataUpdateStrategy</code> bean allows you to update the metadata at runtime.</p>
</div>
<div class="paragraph">
<p>If you look at <a href="https://spring.io/projects/spring-boot">the project home page for Spring
Boot</a>, the latest versions are displayed. <code>SpringIoInitializrMetadataUpdateStrategy</code> is an
implementation of that strategy that fetches the latest Spring Boot versions and update
the metadata to make sure a running instance using those conventions always get the latest
available versions.</p>
</div>
<div class="paragraph">
<p>If you are behind a proxy, or need to customize the <code>RestTemplate</code> that is used behind the
scenes, you can define a <code>RestTemplateCustomizer</code> bean in your configuration. For more
details, <a href="https://docs.spring.io/spring-boot/reference/io/rest-client.html#io.rest-client.restclient.customization">check the
documentation</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you opt-in for <code>SpringIoInitializrMetadataUpdateStrategy</code>, you have to
<a href="#create-instance-advanced-config-caching">configure caching</a> to avoid requesting that
service too often.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="create-instance-types"><a class="anchor" href="#create-instance-types"></a>7.4. Configuring available project types</h3>
<div class="paragraph">
<p>The available project types mostly define the structure of the generated project and its
build system. Once a project type is selected, the related action is invoked to generate
the project.</p>
</div>
<div class="paragraph">
<p>By default, Spring Initializr exposes the following resources (all accessed via HTTP GET):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/pom.xml</code> generate a Maven <code>pom.xml</code></p>
</li>
<li>
<p><code>/build.gradle</code> generate a Gradle build</p>
</li>
<li>
<p><code>/starter.zip</code> generate a complete project structure archived in a zip</p>
</li>
<li>
<p><code>/starter.tgz</code> generate a complete project structure archived in a tgz</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The build system must be defined with a <code>build</code> tag providing the name of the
<code>BuildSystem</code> to use (e.g. <code>maven</code>, <code>gradle</code>).</p>
</div>
<div class="paragraph">
<p>Additional tags can be provided to further qualify the entry. If the build system supports
multiple dialects, the chosen dialect can be specified using the <code>dialect</code> tag.</p>
</div>
<div class="paragraph">
<p>A <code>format</code> tag is also available to define the format of the project (e.g. <code>project</code>
for a full project, <code>build</code> for just a build file). By default, the HTML UI filters all
the available types to only display the ones that have a <code>format</code> tag with value
<code>project</code>.</p>
</div>
<div class="paragraph">
<p>You can of course implement additional endpoints that generate whatever project structure
you need but, for now, we&#8217;ll simply configure our instance to generate a Gradle or a Maven
project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  types:
    - name: Maven Project
      id: maven-project
      description: Generate a Maven based project archive
      tags:
        build: maven
        format: project
      default: true
      action: /starter.zip
    - name: Gradle Project
      id: gradle-project
      description: Generate a Gradle based project archive
      tags:
        build: gradle
        format: project
      default: false
      action: /starter.zip</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you intend to build a custom client against your service, you can add as many
tags as you want, and process them in the client in a way that makes sense for your users.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For instance, the Spring Boot CLI uses them as a shortcut to the full type id. So rather
than having to create a Gradle project as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ spring init --type=gradle-project my-project.zip</pre>
</div>
</div>
<div class="paragraph">
<p>You can simply define a more convenient build parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ spring init --build=gradle my-project.zip</pre>
</div>
</div>
<div class="paragraph">
<p>With that configuration, you should be able to generate your first project,
congratulations! Let&#8217;s now add dependencies so that you can start searching for them.</p>
</div>
</div>
<div class="sect2">
<h3 id="create-instance-dependencies"><a class="anchor" href="#create-instance-dependencies"></a>7.5. Configuring dependencies</h3>
<div class="paragraph">
<p>The most basic <code>dependency</code> is composed of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An <code>id</code> used in clients to refer to it</p>
</li>
<li>
<p>The full maven coordinates of the dependency (<code>groupId</code> and <code>artifactId</code>)</p>
</li>
<li>
<p>A display <code>name</code> (used in the UI and the search results)</p>
</li>
<li>
<p>A <code>description</code> can (and should) be added to provide more information about the
dependency</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Spring Initializr automatically considers that a dependency without maven coordinates
defines an official Spring Boot starter. In such a case, the <code>id</code> is used to infer the
<code>artifactId</code>.</p>
</div>
<div class="paragraph">
<p>For instance, the following configures the <code>spring-boot-starter-web</code> Starter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  dependencies:
    - name: Web
      content:
        - name: Web
          id: web
          description: Full-stack web development with Tomcat and Spring MVC</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each dependency is contained in a <em>group</em> that gathers dependencies sharing a common
surface area or any other form of grouping. In the example above, a <code>Web</code> group holds our
unique dependency. A group can also provide default values for various settings, see the
<a href="#howto-group-share-settings">dedicated how-to</a> for more details.</p>
</div>
<div class="paragraph">
<p>In our <code>spring-boot-starter-web</code> example above, we assume that the dependency is <em>managed</em>
by the platform so there is no need to provide a <code>version</code> attribute for it. You&#8217;ll surely
need to define additional dependencies that are not provided by the platform and we
strongly recommend you to use a <a href="#create-instance-boms">Bill Of Materials (or BOM)</a>.</p>
</div>
<div class="paragraph">
<p>If no BOM is available you can specify a version directly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  dependencies:
    - name: Tech
      content:
        - name: Acme
          id: acme
          groupId: com.example.acme
          artifactId: acme
          version: 1.2.0.RELEASE
          description: A solid description for this dependency</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you add this configuration and search for "acme" (or "solid"), you&#8217;ll find this extra
entry; generating a maven project with it should add the following to the pom:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.example.acme&lt;/groupId&gt;
    &lt;artifactId&gt;acme&lt;/artifactId&gt;
    &lt;version&gt;1.2.0.RELEASE&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The rest of this section will detail the other configuration options.</p>
</div>
<div class="sect3">
<h4 id="dependencies-compatibility-range"><a class="anchor" href="#dependencies-compatibility-range"></a>7.5.1. Compatibility Range</h4>
<div class="paragraph">
<p>By default, a dependency is available regardless of the platform version you have
selected. If you need to restrict a dependency to a certain platform generation you
can add a <code>compatibilityRange</code> attribute to its definition that defines a version range. A
version range is a range of versions of the platform which are valid in combination with
it. The versions are <strong>not</strong> applied to the dependency itself, but rather used to filter out
the dependency, or modify it, when different versions of the platform are selected for the
generated project.</p>
</div>
<div class="paragraph">
<p>A version is composed of four parts: a major revision, a minor revision, a patch
revision and an optional qualifier. Spring Initializr supports two version formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>V1</code> is the original format where the qualifier is separated from the version by a dot.
It also uses well-defined qualifiers for snapshots (<code>BUILD-SNAPSHOT</code>) and General
Availability (<code>RELEASE</code>).</p>
</li>
<li>
<p><code>V2</code> is an improved format that is SemVer compliant, and therefore uses a dash to
separate the qualifier. There is no qualifier for GAs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Speaking of qualifiers, they are ordered as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>M</code> for milestones (e.g. <code>2.0.0.M1</code> is the first milestone of the upcoming 2.0.0
release): can be seen as "beta" release</p>
</li>
<li>
<p><code>RC</code> for release candidates (e.g. <code>2.0.0-RC2</code> is the second release candidate of
upcoming 2.0.0 release)</p>
</li>
<li>
<p><code>BUILD-SNAPSHOT</code> for development build (<code>2.1.0.BUILD-SNAPSHOT</code> represents the latest
available development build of the upcoming 2.1.0 release). For the <code>V2</code> format, it is
simply <code>SNAPSHOT</code>, i.e. <code>2.1.0-SNAPSHOT</code>.</p>
</li>
<li>
<p><code>RELEASE</code> for general availability (e.g. <code>2.0.0.RELEASE</code> is 2.0.0 proper)</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Snapshots are in a bit special in that scheme as they always represent the "latest
state" of a release. <code>M1</code> represents the oldest version for a given major, minor and
patch revisions, and it can therefore be safely used when referring to the "first" release
in that line.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A version range has a lower and an upper bound, and if the bound is inclusive it is
denoted as a square bracket (<code>[</code> or <code>]</code>), otherwise it is exclusive and denoted by a
parenthesis (<code>(</code> or <code>)</code>). For instance <code>[1.1.6.RELEASE,1.3.0.M1)</code> means from all versions
from <code>1.1.6.RELEASE</code> up to but not including <code>1.3.0.M1</code> (concretely no including the
<code>1.3.x</code> line and after).</p>
</div>
<div class="paragraph">
<p>A version range can be a single value, e.g. <code>1.2.0.RELEASE</code>, which is short for "this
version or greater". It is an inclusive lower bound with an implied infinite upper bound.</p>
</div>
<div class="paragraph">
<p>If you need to specify "the latest release" in a given line, you can use a <code>x</code> rather than
an hard-coded version. For instance, <code>1.4.x.BUILD-SNAPSHOT</code> is the latest snapshot build
of the 1.4.x line. For instance, if you want to restrict a dependency from <code>1.1.0.RELEASE</code>
to the latest stable release of the 1.3.x line, you&#8217;d use <code>[1.1.0.RELEASE,1.3.x.RELEASE]</code>.</p>
</div>
<div class="paragraph">
<p>Snapshots are naturally the most recent version of a given line, so if you are looking to
match a dependency to only the latest snapshots of the platform, you could use a version
range of <code>1.5.x.BUILD-SNAPSHOT</code> (assuming 1.5 was the latest).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Remember to quote the values of a version range in YAML configuration files (with
double quotes "").
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See below in the section on <a href="#howto-link-platform-version">linking versions</a> for more examples
and idioms. See also how the <a href="#howto-platform-version-format">platform version format</a> can
be configured.</p>
</div>
</div>
<div class="sect3">
<h4 id="dependencies-repository"><a class="anchor" href="#dependencies-repository"></a>7.5.2. Repository</h4>
<div class="paragraph">
<p>If the dependency is not available on Maven Central (or whatever default repository that
is configured on your end), you can also add a reference to a repository. A repository is
declared at the top level (under <code>env</code>) and given an id via the key in the configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  env:
    repositories:
      my-api-repo-1:
        name: repo1
        url: https://example.com/repo1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once defined, the repository can then be referred back to in a dependency</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  dependencies:
    - name: Other
      content:
        - name: Foo
          groupId: org.acme
          artifactId: foo
          version: 1.3.5
          repository: my-api-repo-1</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is usually preferable to have a BOM for every dependency, and attach the repository to
the BOM instead.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The snapshots and milestones repositories on <code>repo.spring.io</code> are automatically
available with the <code>spring-snapshots</code> and <code>spring-milestones</code> identifiers respectively.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-instance-boms"><a class="anchor" href="#create-instance-boms"></a>7.6. Configuring Bill of Materials</h3>
<div class="paragraph">
<p>A Bill of Materials (BOM) is a special <code>pom.xml</code>, deployed to a Maven repository, and used
to control dependency management for a set of related artifacts. In the Spring Boot
ecosystem we usually use the suffix <code>-dependencies</code> on the artifact id of a BOM. In other
projects we see <code>-bom</code>. It is recommended that all dependencies are included in a BOM of
some sort, since they provide nice high level features for users of the dependency. It is
also important that 2 BOMs used in a project do not contain conflicting versions for the
same dependency, so the best practice is to look at the existing BOMs in Spring Initializr
before you add a new one, and make sure that you aren&#8217;t adding a conflict.</p>
</div>
<div class="paragraph">
<p>In Spring Initializr a BOM is declared at the <code>env</code> level, and given an id through the
configuration key. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  env:
    boms:
      my-api-bom:
        groupId: org.acme
        artifactId: my-api-dependencies
        version: 1.0.0.RELEASE
        repositories: my-api-repo-1</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a BOM requires a special, non-default repository, then it can be referred to here,
instead of having to explicitly list the repository again for each dependency. A
dependency, or a dependency group, can declare that it requires the use of one or more
BOMs by referring to the id:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  dependencies:
    - name: Other
      content:
        - name: My API
          id : my-api
          groupId: org.acme
          artifactId: my-api
          bom: my-api-bom</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="dependencies-mappings"><a class="anchor" href="#dependencies-mappings"></a>7.6.1. Map coordinates according to the platform version</h4>
<div class="paragraph">
<p>In addition to a compatibility range for the dependency or a BOM, you can configure
the version relationships at a finer grained level using version mappings. A dependency or
BOM has a list of "mappings", each of which consists of a version range, and a set of one
or more dependency properties to override for those versions of the platform. You can use
a mapping to switch the version of a dependency, or (better) the BOM, or to change its
artifact id (if the project changed its packaging) for instance.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of a BOM with mappings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  env:
    boms:
      cloud-bom:
        groupId: com.example.foo
        artifactId: acme-foo-dependencies
        mappings:
          - compatibilityRange: "[1.2.3.RELEASE,1.3.0.RELEASE)"
            groupId: com.example.bar
            artifactId: acme-foo-bom
            version: Arcturus.SR6
          - compatibilityRange: "[1.3.0.RELEASE,1.4.0.RELEASE)"
            version: Botein.SR7
          - compatibilityRange: "[1.4.0.RELEASE,1.5.x.RELEASE)"
            version: Castor.SR6
          - compatibilityRange: "[1.5.0.RELEASE,1.5.x.BUILD-SNAPSHOT)"
            version: Diadem.RC1
            repositories: spring-milestones
          - compatibilityRange: "1.5.x.BUILD-SNAPSHOT"
            version: Diadem.BUILD-SNAPSHOT
            repositories: spring-snapshots,spring-milestones</code></pre>
</div>
</div>
<div class="paragraph">
<p>The primary use case here is to map platform versions to the preferred or supported
versions of the Foo project. You can also see that for the milestone and snapshot BOMs,
additional repositories are declared because those artifacts are not in the default
repository. Initially the BOM was identified as <code>com.example.bar:acme-foo-bom</code> and renamed
as of <code>Botein</code> to <code>com.example.foo:acme-foo-dependencies</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
We also use the <code>x</code> trick in version ranges to avoid updating the range every time
a new platform 1.5 bug fix release is available.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See below in the section on <a href="#howto-link-platform-version">linking versions</a> for more examples.</p>
</div>
</div>
<div class="sect3">
<h4 id="dependencies-alias"><a class="anchor" href="#dependencies-alias"></a>7.6.2. Aliases</h4>
<div class="paragraph">
<p>A dependency has an id (e.g. "web-services"), but it could be necessary to provide a new
id and still be able to serve request from client using the now deprecated id. To do so,
an alias can be defined for ths dependency;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  dependencies:
    - name: Other
      content:
        - name: Web Services
          id: web-services
          aliases:
            - ws</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same project can now be generated with <code>dependencies=ws</code> or
<code>dependencies=web-services</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="dependencies-facet"><a class="anchor" href="#dependencies-facet"></a>7.6.3. Facets</h4>
<div class="paragraph">
<p>A "facet" is a label on a dependency which is used to drive a code modification in the
generated project. For example, <code>initializr-generator-spring</code> checks for the presence of a
dependency with the <code>web</code> facet if the packaging type is <code>war</code>. The absence of a
dependency with the <code>web</code> facet drives inclusion of a dependency with id <code>web</code> (defaulting
to <code>spring-boot-starter-web</code> if such dependency is not available).</p>
</div>
<div class="paragraph">
<p>The value of the "facets" property of a dependency is a list of strings.</p>
</div>
</div>
<div class="sect3">
<h4 id="create-instance-dependencies-link"><a class="anchor" href="#create-instance-dependencies-link"></a>7.6.4. Links</h4>
<div class="paragraph">
<p>Links can be used to provide descriptive and hyperlink data to guide to user on how to
learn more about a dependency. A dependency has a "links" property which is a list of
<code>Link</code>. Each link has a <code>rel</code> label to identify it, an <code>href</code> and an optional (but
recommended) <code>description</code>.</p>
</div>
<div class="paragraph">
<p>The following <code>rel</code> value are currently officially supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>guide</code>: the link points to a guide describing how to use the related dependency. It
can be a tutorial, a how-to or typically a guide available on <a href="https://spring.io/guides" class="bare">spring.io/guides</a></p>
</li>
<li>
<p><code>reference</code>: the link points to a section of a developer guide typically or any page that
documents how to use the dependency</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The url can be templated if its actual value can change according to the environment. An
URL parameter is specified with curly braces, something like
<code><a href="https://example.com/doc/{bootVersion}/section" class="bare">example.com/doc/{bootVersion}/section</a></code> defines a <code>bootVersion</code> parameter.</p>
</div>
<div class="paragraph">
<p>The following attributes are currently supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>bootVersion</code>: the platform version that is currently active (named <code>bootVersion</code> for
backward compatibility with the metadata format)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is an example that adds two links to the <code>acme</code> dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  dependencies:
    - name: Tech
      content:
        - name: Acme
          id: acme
          groupId: com.example.acme
          artifactId: acme
          version: 1.2.0.RELEASE
          description: A solid description for this dependency
          links:
            - rel: guide
              href: https://com.example/guides/acme/
              description: Getting started with Acme
            - rel: reference
              href: https://docs.example.com/acme/html</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-access"><a class="anchor" href="#configuration-access"></a>8. Generating a Project using the Web Endpoints</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To discover the available options of a particular instance, simply "curl it". Assuming
that an instance is running on your machine on the default port, invoke the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl http://localhost:8080</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you prefer <code>HTTPie</code>, you can discover the available options as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ http http://localhost:8080</pre>
</div>
</div>
<div class="paragraph">
<p>The result is a textual representation of the capabilities of the service that are split
in three sections:</p>
</div>
<div class="paragraph">
<p>First, a table that describes the <a href="#create-instance-types">available project types</a>.</p>
</div>
<div class="paragraph">
<p>Then, a table that describes the <a href="#initializr-generator-project">available parameters</a>.</p>
</div>
<div class="paragraph">
<p>Finally, the list of dependencies are defined. Each entry provides the identifier that
you&#8217;ll have to use if you want to select the dependency, a description and the
compatibility range, if any.</p>
</div>
<div class="paragraph">
<p>Alongside the capabilities of the service, you&#8217;ll also find a few examples that help you
understand how you can generate a project. These are obviously tailored to the client that
you are using.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s assume that you want to generate a "my-project.zip" project based on version
<code>2.3.5.RELEASE</code> of the platform, using the <code>web</code> and <code>devtools</code> dependencies (remember,
those two ids are displayed in the capabilities of the service):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ curl -G http://localhost:8080/starter.zip -d dependencies=web,devtools \
           -d bootVersion=2.3.5.RELEASE -o my-project.zip</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you extract <code>my-project.zip</code>, you&#8217;ll notice a few differences compared to what happens
with the web UI:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The project will be extracted in the current directory (the web UI adds a base directory
automatically with the same name as the one of the project)</p>
</li>
<li>
<p>The name of the project is not <code>my-project</code> (the <code>-o</code> parameter has no impact on the
name of the project)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The exact same project can be generated using the <code>http</code> command as well:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ http https://localhost:8080/starter.zip dependencies==web,devtools \
           bootVersion==2.3.5.RELEASE -d</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>HTTPie</code> reads the same hint as the browser so it will store a <code>demo.zip</code> file in
the current directory, with the same differences discussed above.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-howto"><a class="anchor" href="#configuration-howto"></a>9. &#8216;How-to&#8217; guides</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section provides answers to some common &#8216;how do I do that&#8230;&#8203;&#8217; type of questions
that often arise when configuring Spring Initializr.</p>
</div>
<div class="sect2">
<h3 id="howto-add-a-new-dependency"><a class="anchor" href="#howto-add-a-new-dependency"></a>9.1. Add a new dependency</h3>
<div class="paragraph">
<p>To add a new dependency, first identify the Maven coordinates of the dependency you want
to add (<code>groupId:artifactId:version</code>) and then check which versions of the platform it
works with. If there are multiple versions that work with different versions of the
platform, then that&#8217;s fine too.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If there is a published BOM that manages the version of you dependency, then add that
first, in the <code>env</code> section (see <a href="#create-instance-boms">Configuring Bill of Materials</a>).</p>
</li>
<li>
<p>Then configure the dependency, fitting it into an existing group if you can, otherwise
creating a new group.</p>
</li>
<li>
<p>If there is a BOM then omit the version.</p>
</li>
<li>
<p>If there is a compatibility version range (or min or max) that you need for this
dependency, add that as a <a href="#howto-link-platform-version">linked version</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="howto-override-a-version"><a class="anchor" href="#howto-override-a-version"></a>9.2. Override the version of a dependency</h3>
<div class="paragraph">
<p>Sometimes it happens that the BOM that normally manages your dependency version is in
conflict with the newest version. Or maybe this is the case for only a range of Spring
Boot versions. Or maybe there just is no BOM, or it&#8217;s not worth creating one for just one
dependency. In these cases you can specify the version manually for a dependency either
at the top level, or in a
<a href="#howto-link-platform-version">version mapping</a>. At the top level it looks like this (just
a <code>version</code> property in a dependency):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  dependencies:
    - name: Tech
      content:
        - name: Acme
          id: acme
          groupId: com.example.acme
          artifactId: acme
          version: 1.2.0.RELEASE
          description: A solid description for this dependency</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto-link-platform-version"><a class="anchor" href="#howto-link-platform-version"></a>9.3. Link a version of the platform to a version of your dependency</h3>
<div class="paragraph">
<p>If your dependency requires a specific version of the platform, ot different versions of
the platform require different versions of your dependency there are a couple of
mechanisms to configure that.</p>
</div>
<div class="paragraph">
<p>The simplest is to put a <code>compatibilityRange</code> in the dependency declaration. This is a
range of versions of the platform, not of your dependency. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  dependencies:
    - name: Stuff
      content:
        - name: Foo
          id: foo
          ...
          compatibilityRange: 1.2.0.M1
        - name: Bar
          id: bar
          ...
          compatibilityRange: "[1.5.0.RC1,2.0.0.M1)"</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example <code>Foo</code> is available for as of <code>1.2.0</code> of the platform, and <code>Bar</code> is
available for versions of the platform starting at <code>1.5.0.RC1</code> and up to, but not
including, <code>2.0.0.M1</code>.</p>
</div>
<div class="paragraph">
<p>If different versions of your dependency work with different versions of the platform,
that&#8217;s when you need the <code>mappings</code> property. A mapping is a combination of a
<code>compatibilityRange</code> and some or all of the other properties of the dependency, overriding
the values defined at the top level. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  dependencies:
    - name: Stuff
      content:
        - name: Foo
          id: foo
          groupId: org.acme.foo
          artifactId: foo-spring-boot-starter
          compatibilityRange: 1.3.0.RELEASE
          bom: cloud-task-bom
          mappings:
            - compatibilityRange: "[1.3.0.RELEASE,1.3.x.RELEASE]"
              artifactId: foo-starter
            - compatibilityRange: "1.4.0.RELEASE"</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, The artifact of <code>foo</code> was changed to <code>foo-spring-boot-starter</code> as of the
version that is compatible as of <code>1.4.0</code> of the platform. This mapping instructs that if
<code>1.3.x</code> of the platform is selected, the artifactId should be set to <code>foo-starter</code>.</p>
</div>
<div class="paragraph">
<p>A mapping can also be applied to a BOM declaration. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  env:
    boms:
      my-api-bom:
        groupId: org.acme
        artifactId: my-api-bom
        additionalBoms: ['my-api-dependencies-bom']
        mappings:
          - compatibilityRange: "[1.0.0.RELEASE,1.1.6.RELEASE)"
            version: 1.0.0.RELEASE
            repositories: my-api-repo-1
          - compatibilityRange: "1.2.1.RELEASE"
            version: 2.0.0.RELEASE
            repositories: my-api-repo-2</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, versions of the platform up to <code>1.1.6</code> select version <code>1.0.0</code> of the BOM,
and set a different repository. Versions of the platform as of <code>1.2.1</code> select <code>2.0.0</code> of
the BOM and yet another repository.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto-add-snapshot-repository"><a class="anchor" href="#howto-add-snapshot-repository"></a>9.4. Configure a snapshot repository</h3>
<div class="paragraph">
<p>A dependency, or a BOM, might require the use of a specific repository, if the default one
(usually Maven Central) does not contain the artifacts. Normally, the best place to
declare that is in the BOM configuration, but if there isn&#8217;t a BOM then you can put it in
the dependency itself. You can also use a platform <a href="#dependencies-mappings">version
mapping</a> to override the default repository for a dependency or BOM.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto-configure-custom-parent-pom"><a class="anchor" href="#howto-configure-custom-parent-pom"></a>9.5. Configure a custom parent POM</h3>
<div class="paragraph">
<p>For Maven projects, you can configure a custom parent POM as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  env:
    maven:
      parent:
        groupId: com.example
        artifactId: my-parent
        version: 1.0.0
        relativePath: ../pom.xml
        includeSpringBootBom : true</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>relativePath</code> is not specified, the pom is resolved from the repository.</p>
</div>
<div class="paragraph">
<p><code>includeSpringBootBom</code> is <code>false</code> by default. When set to <code>true</code>, the
<code>spring-boot-dependencies</code> bom is added to the <code>dependencyManagement</code> section with the
version of Spring Boot used for the project.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto-dependency-starter-flag"><a class="anchor" href="#howto-dependency-starter-flag"></a>9.6. Make sure a regular dependency brings the base starter</h3>
<div class="paragraph">
<p>If a dependency does not stand on its own (and specifically if it does not depend on an
existing Spring Boot starter) you can flag it as a "non starter":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  dependencies:
    - name: Stuff
      content:
        - name: Lib
          id: lib
          groupId: com.acme
          artifactId: lib
          starter: false</code></pre>
</div>
</div>
<div class="paragraph">
<p>When a project is generated that only has dependencies with this flag set, then the base
Spring Boot starter is added as well.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto-group-share-settings"><a class="anchor" href="#howto-group-share-settings"></a>9.7. Share common dependency settings in a group</h3>
<div class="paragraph">
<p>A dependency group is a hint for user interface implementations, to group things together
for users when they are selecting dependencies. It is also a convenient way to share
settings between dependencies because every dependency inherits all the settings. The most
common settings in a group are the <code>groupId</code>, <code>compatibilityRange</code> and <code>bom</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  dependencies:
    - name: Stuff
      bom: stuff-bom
      compatibilityRange: "[1.3.0.RELEASE,2.0.0.M1)"
      content:
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>These dependencies, by default, will be available only for versions of the platform as of
<code>1.3.0.RELEASE</code> up to <code>2.0.0.M1</code> (excluded) and will bring in the <code>stuff-bom</code> BOM.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto-kotlin-version-mapping"><a class="anchor" href="#howto-kotlin-version-mapping"></a>9.8. Configure Kotlin version mapping</h3>
<div class="paragraph">
<p>By default, the Kotlin version to use is inferred from the metadata.
The following example shows how to map two versions of Kotlin based on the platform version.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  env:
    kotlin:
      mappings:
        - compatibilityRange: "[2.0.0.RELEASE,2.4.0-M1)"
          version: 1.2
        - compatibilityRange: "2.4.0-M1"
          version: 1.3</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a more advanced resolution, consider implementing a <code>KotlinVersionResolver</code> bean.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto-platform-version-format"><a class="anchor" href="#howto-platform-version-format"></a>9.9. Configure platform version format</h3>
<div class="paragraph">
<p>Spring Initializr supports two formats: <code>V1</code> is the original format defined by metadata
up to <code>2.1</code>. <code>V2</code> is the SemVer format provided alongside <code>V1</code> as of metadata <code>2.2</code>. In
order to serve backward compatible content, the version range for each format should be
configured so that translations can happen accordingly.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s assume that an instance only supports <code>2.0.0</code> and later and the platform version is
using the original format up to <code>2.4.0</code> (excluded). As of <code>2.4.0</code>, the improved, SemVer
format is used. The following configures the instance to adapt version format
automatically:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">initializr:
  env:
    platform:
      compatibility-range: "2.0.0.RELEASE"
      v1-format-compatibility-range: "[2.0.0.RELEASE,2.4.0-M1)"
      v2-format-compatibility-range: "2.4.0-M1"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-instance-advanced-config"><a class="anchor" href="#create-instance-advanced-config"></a>10. Advanced configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="create-instance-advanced-config-caching"><a class="anchor" href="#create-instance-advanced-config-caching"></a>10.1. Caching configuration</h3>
<div class="paragraph">
<p>If you use the service, you&#8217;ll notice that the logs have lots of entries with the message
<code>Fetching boot metadata from <a href="https://api.spring.io/projects/spring-boot/releases" class="bare">api.spring.io/projects/spring-boot/releases</a></code>. To avoid
checking for the latest Spring Boot versions too often, you should enable caching on your
service.</p>
</div>
<div class="paragraph">
<p>Spring Initializr has an auto-configuration for the requested caches if you are willing to
use a JCache (JSR-107) implementation. By default, the service metadata cache is
configured with an expiration policy that allows entries to remain in the cache for 10
minutes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The caches are created with an auto-configured <code>JCacheManagerCustomizer</code> with order <code>0</code> and only if they don&#8217;t exist already.
You can contribute a bean of the same type with a lower <code>@Order</code> to override some of the configuration to suit your specific needs.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Add the <code>javax.cache:cache-api</code> and your favorite JCache implementation and simply enable
caching by adding <code>@EnableCaching</code> to your <code>@SpringBootApplication</code>. For instance, you
could use <code>ehcache</code> by adding the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;javax.cache&lt;/groupId&gt;
    &lt;artifactId&gt;cache-api&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.ehcache&lt;/groupId&gt;
    &lt;artifactId&gt;ehcache&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or if you are using Gradle:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">implementation("javax.cache:cache-api")
implementation("org.ehcache:ehcache")
</code></pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll notice that the log entry is much more rare. If you do not want to use JSR-107, you
should configure the cache yourselves. Here are the caches used by the application (each
one will require some configuration to get it working):</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Cache configuration</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">cache name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>initializr.metadata</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cache the full metadata of the service. When the metadata expires, it is fully resolved
again (which may include a network call to determine the latest platform versions). Adapt
the expiration settings accordingly.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>initializr.dependency-metadata</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cache dependency-specific metadata.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>initializr.templates</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cache templates that are used to generate projects.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="create-instance-advanced-config-custom-project-request"><a class="anchor" href="#create-instance-advanced-config-custom-project-request"></a>10.2. Bind to custom project request</h3>
<div class="paragraph">
<p>Only attributes that are defined in the metadata can be bound to a <code>ProjectRequest</code> and
ultimately made available in <code>ProjectDescription</code>. A custom instance may choose however to
provide additional attributes. Please note that those attributes won&#8217;t be supported by
official clients (i.e. IDEs).</p>
</div>
<div class="paragraph">
<p>The first step is to define a custom <code>ProjectRequest</code> with your additional attributes and
create a custom <code>ProjectGenerationController</code> that binds to it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class CustomProjectGenerationController extends ProjectGenerationController&lt;CustomProjectRequest&gt; {

    public CustomProjectGenerationController(InitializrMetadataProvider metadataProvider,
            ProjectGenerationInvoker&lt;CustomProjectRequest&gt; projectGenerationInvoker) {
        super(metadataProvider, projectGenerationInvoker);
    }

    @Override
    public CustomProjectRequest projectRequest(Map&lt;String, String&gt; headers) {
        CustomProjectRequest request = new CustomProjectRequest();
        request.getParameters().putAll(headers);
        request.initialize(getMetadata());
        return request;
    }

}
</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you inherit from <code>WebProjectRequest</code>, defaults can be automatically applied from the
metadata as shown above but you may also choose to ignore that.</p>
</div>
<div class="paragraph">
<p>The next step is to make sure that those additional attributes are made available in the
<code>ProjectGenerationContext</code>. The idiomatic way of doing this is to create your own
interface that extends from <code>ProjectDescription</code> and expose your custom attributes. To
make sure your view of <code>ProjectDescription</code> is made available in the
<code>ProjectGenerationContext</code>, a custom <code>ProjectRequestToDescriptionConverter</code> should be
defined and could reuse <code>DefaultProjectRequestToDescriptionConverter</code> to apply general
rules for standard fields.</p>
</div>
<div class="paragraph">
<p>Finally, you should wire up everything:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Bean
public CustomProjectGenerationController projectGenerationController(InitializrMetadataProvider metadataProvider,
        ApplicationContext applicationContext) {
    ProjectGenerationInvoker&lt;CustomProjectRequest&gt; projectGenerationInvoker = new ProjectGenerationInvoker&lt;&gt;(
            applicationContext, new CustomProjectRequestToDescriptionConverter());
    return new CustomProjectGenerationController(metadataProvider, projectGenerationInvoker);
}
</code></pre>
</div>
</div>
</div>
</div>
</div>
<h1 id="api-guide" class="sect0"><a class="anchor" href="#api-guide"></a>API Guide</h1>
<div class="sect1">
<h2 id="metadata-format"><a class="anchor" href="#metadata-format"></a>11. Metadata Format</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the hal/json structure of the metadata exposed by the
initializr. Such metadata can be used by third party clients to provide a list of
options and default settings that can be used to request the creation of a project.</p>
</div>
<div class="paragraph">
<p>A third-party client is advised to set a <code>User-Agent</code> header for <strong>each</strong> request
sent to the service. A good structure for a user agent is <code>clientId/clientVersion</code>
(i.e. <code>foo/1.2.0</code> for the "foo" client and version <code>1.2.0</code>).</p>
</div>
<div class="sect2">
<h3 id="service-capabilities"><a class="anchor" href="#service-capabilities"></a>11.1. Service Capabilities</h3>
<div class="paragraph">
<p>Any third party client can retrieve the capabilities of the service by issuing a
<code>GET</code> on the root URL using the following <code>Accept</code> header:
<code>application/vnd.initializr.v2.2+json</code>. Please note that the metadata may evolve in a
non backward compatible way in the future so adding this header ensures the service
returns the metadata format you expect.</p>
</div>
<div class="paragraph">
<p>The following versions are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>v2</code> initial version, with support of V1 version format only</p>
</li>
<li>
<p><code>v2.1</code> support compatibility range and dependencies links</p>
</li>
<li>
<p><code>v2.2</code> (current) support for V1 and V2 version formats.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is an example output for a service running at <code>start.example.com</code>:</p>
</div>
<div class="listingblock">
<div class="title">request</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">GET / HTTP/1.1
Accept: application/vnd.initializr.v2.2+json
Host: start.example.com</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">response</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
ETag: "02842ebd1bdc7f2250fd7e76c2840951"
Content-Type: application/vnd.initializr.v2.2+json
Vary: Accept
Cache-Control: max-age=7200
Content-Length: 4842

{
  "_links" : {
    "maven-build" : {
      "href" : "http://start.example.com/pom.xml?type=maven-build{&amp;dependencies,packaging,javaVersion,language,bootVersion,groupId,artifactId,version,name,description,packageName}",
      "templated" : true
    },
    "maven-project" : {
      "href" : "http://start.example.com/starter.zip?type=maven-project{&amp;dependencies,packaging,javaVersion,language,bootVersion,groupId,artifactId,version,name,description,packageName}",
      "templated" : true
    },
    "gradle-build" : {
      "href" : "http://start.example.com/build.gradle?type=gradle-build{&amp;dependencies,packaging,javaVersion,language,bootVersion,groupId,artifactId,version,name,description,packageName}",
      "templated" : true
    },
    "gradle-project" : {
      "href" : "http://start.example.com/starter.zip?type=gradle-project{&amp;dependencies,packaging,javaVersion,language,bootVersion,groupId,artifactId,version,name,description,packageName}",
      "templated" : true
    },
    "dependencies" : {
      "href" : "http://start.example.com/dependencies{?bootVersion}",
      "templated" : true
    }
  },
  "dependencies" : {
    "type" : "hierarchical-multi-select",
    "values" : [ {
      "name" : "Core",
      "values" : [ {
        "id" : "web",
        "name" : "Web",
        "description" : "Web dependency description",
        "_links" : {
          "guide" : {
            "href" : "https://example.com/guide",
            "title" : "Building a RESTful Web Service"
          },
          "reference" : {
            "href" : "https://example.com/doc"
          }
        }
      }, {
        "id" : "security",
        "name" : "Security"
      }, {
        "id" : "data-jpa",
        "name" : "Data JPA"
      } ]
    }, {
      "name" : "Other",
      "values" : [ {
        "id" : "org.acme:foo",
        "name" : "Foo",
        "_links" : {
          "guide" : [ {
            "href" : "https://example.com/guide1"
          }, {
            "href" : "https://example.com/guide2",
            "title" : "Some guide for foo"
          } ],
          "reference" : {
            "href" : "https://example.com/{bootVersion}/doc",
            "templated" : true
          }
        }
      }, {
        "id" : "org.acme:bar",
        "name" : "Bar"
      }, {
        "id" : "org.acme:biz",
        "name" : "Biz",
        "versionRange" : "2.6.0-SNAPSHOT"
      }, {
        "id" : "org.acme:bur",
        "name" : "Bur",
        "versionRange" : "[2.4.4,2.5.0-SNAPSHOT)"
      }, {
        "id" : "my-api",
        "name" : "My API"
      } ]
    } ]
  },
  "type" : {
    "type" : "action",
    "default" : "maven-project",
    "values" : [ {
      "id" : "maven-build",
      "name" : "Maven POM",
      "action" : "/pom.xml",
      "tags" : {
        "build" : "maven",
        "format" : "build"
      }
    }, {
      "id" : "maven-project",
      "name" : "Maven Project",
      "action" : "/starter.zip",
      "tags" : {
        "build" : "maven",
        "format" : "project"
      }
    }, {
      "id" : "gradle-build",
      "name" : "Gradle Config",
      "action" : "/build.gradle",
      "tags" : {
        "build" : "gradle",
        "format" : "build"
      }
    }, {
      "id" : "gradle-project",
      "name" : "Gradle Project",
      "action" : "/starter.zip",
      "tags" : {
        "build" : "gradle",
        "format" : "project"
      }
    } ]
  },
  "packaging" : {
    "type" : "single-select",
    "default" : "jar",
    "values" : [ {
      "id" : "jar",
      "name" : "Jar"
    }, {
      "id" : "war",
      "name" : "War"
    } ]
  },
  "javaVersion" : {
    "type" : "single-select",
    "default" : "1.8",
    "values" : [ {
      "id" : "1.6",
      "name" : "1.6"
    }, {
      "id" : "1.7",
      "name" : "1.7"
    }, {
      "id" : "1.8",
      "name" : "1.8"
    } ]
  },
  "language" : {
    "type" : "single-select",
    "default" : "java",
    "values" : [ {
      "id" : "groovy",
      "name" : "Groovy"
    }, {
      "id" : "java",
      "name" : "Java"
    }, {
      "id" : "kotlin",
      "name" : "Kotlin"
    } ]
  },
  "bootVersion" : {
    "type" : "single-select",
    "default" : "2.4.4",
    "values" : [ {
      "id" : "2.5.0-SNAPSHOT",
      "name" : "Latest SNAPSHOT"
    }, {
      "id" : "2.4.4",
      "name" : "2.4.4"
    }, {
      "id" : "2.3.10.RELEASE",
      "name" : "2.3.10"
    } ]
  },
  "groupId" : {
    "type" : "text",
    "default" : "com.example"
  },
  "artifactId" : {
    "type" : "text",
    "default" : "demo"
  },
  "version" : {
    "type" : "text",
    "default" : "0.0.1-SNAPSHOT"
  },
  "name" : {
    "type" : "text",
    "default" : "demo"
  },
  "description" : {
    "type" : "text",
    "default" : "Demo project for Spring Boot"
  },
  "packageName" : {
    "type" : "text",
    "default" : "com.example.demo"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The current capabilities are the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Project dependencies: these are the <em>starters</em> really or actually any dependency
that we might want to add to the project.</p>
</li>
<li>
<p>Project types: these define the action that can be invoked on this service and a
description of what it would produce (for instance a zip holding a pre-configured
Maven project). Each type may have one more tags that further define what it
generates.</p>
</li>
<li>
<p>Packaging: the kind of projects to generate. This merely gives a hint to the
component responsible to generate the project (for instance, generate an executable
<em>jar</em> project).</p>
</li>
<li>
<p>Java version: the supported java versions</p>
</li>
<li>
<p>Language: the language to use (e.g. Java)</p>
</li>
<li>
<p>Boot version: the platform version to use</p>
</li>
<li>
<p>Additional basic information such as: <code>groupId</code>, <code>artifactId</code>,  <code>version</code>, <code>name</code>,
<code>description</code> and <code>packageName</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each top-level attribute (i.e. capability) has a standard format:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>type</code> attribute that defines the semantic of the attribute (see below).</p>
</li>
<li>
<p>A <code>default</code> attribute that defines either the default value or the reference to
the default value.</p>
</li>
<li>
<p>A <code>values</code> attribute that defines the set of acceptable values (if any). This can
be hierarchical (with <code>values</code> being held in <code>values</code>). Each item in a <code>values</code> array
can have an <code>id</code>, <code>name</code> and <code>description</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following attribute <code>type</code> are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>text</code>: defines a simple text value with no option.</p>
</li>
<li>
<p><code>single-select</code>: defines a simple value to be chosen amongst the specified options.</p>
</li>
<li>
<p><code>hierarchical-multi-select</code>: defines a hierarchical set of values (values in
values) with the ability to select multiple values.</p>
</li>
<li>
<p><code>action</code>: a special type that defines the attribute defining the action to use.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each action is defined as a HAL-compliant URL. For instance, the <code>maven-project</code> type
templated URL is defined as follows:</p>
</div>
<div class="listingblock">
<div class="title">Type link example</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-json" data-lang="json">{
  "href" : "http://start.example.com/starter.zip?type=maven-project{&amp;dependencies,packaging,javaVersion,language,bootVersion,groupId,artifactId,version,name,description,packageName}",
  "templated" : true
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use Spring HATEOAS and the <code>UriTemplate</code> helper in particular to generate an
URI from template variables. Note that the variables match the name of top-level
attribute in the metadata document. If you can&#8217;t parse such URI, the <code>action</code>
attribute of each type gives you the root action to invoke on the server. This
requires more manual handling on your end.</p>
</div>
<div class="sect3">
<h4 id="project-dependencies"><a class="anchor" href="#project-dependencies"></a>11.1.1. Project dependencies</h4>
<div class="paragraph">
<p>A dependency is usually the coordinates of a <em>starter</em> module but it can be just a regular
dependency. A typical dependency structure looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "name": "Display name",
  "id": "org.acme.project:project-starter-foo",
  "description": "What starter foo does"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The name is used as a display name to be shown in whatever UI used by the remote
client. The id can be anything, really as the actual dependency definition is
defined through configuration. If no id is defined, a default one is built using the
<code>groupId</code> and <code>artifactId</code> of the dependency. Note in particular that the version is
<strong>never</strong> used as part of an automatic id.</p>
</div>
<div class="paragraph">
<p>Each dependency belongs to a group. The idea of the group is to gather similar
dependencies and order them. Here is a value containing the <code>core</code> group to
illustrates the feature:</p>
</div>
<div class="listingblock">
<div class="title">Dependency group example</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-json" data-lang="json">{
  "name" : "Core",
  "values" : [ {
    "id" : "web",
    "name" : "Web",
    "description" : "Web dependency description",
    "_links" : {
      "guide" : {
        "href" : "https://example.com/guide",
        "title" : "Building a RESTful Web Service"
      },
      "reference" : {
        "href" : "https://example.com/doc"
      }
    }
  }, {
    "id" : "security",
    "name" : "Security"
  }, {
    "id" : "data-jpa",
    "name" : "Data JPA"
  } ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each dependency can have <em>links</em> (in a HAL-compliant format). Links are grouped by
"relations" that provide a semantic to the link. A link can also have a <em>title</em> and
its URI can be templated. At the moment, the only valid parameter is <code>bootVersion</code>.</p>
</div>
<div class="paragraph">
<p>The official relations are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>guide</code>: link to an how-to or guide that explain how to get started</p>
</li>
<li>
<p><code>reference</code>: link to a section of a reference guide (documentation)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="project-types"><a class="anchor" href="#project-types"></a>11.1.2. Project types</h4>
<div class="paragraph">
<p>The <code>type</code> element defines what kind of project can be generated and how. For
instance, if the service exposes the capability to generate a Maven project, this
would look like this:</p>
</div>
<div class="listingblock">
<div class="title">Project type example</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-json" data-lang="json">{
  "id" : "maven-build",
  "name" : "Maven POM",
  "action" : "/pom.xml",
  "tags" : {
    "build" : "maven",
    "format" : "build"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should not rely on the output format depending that information. Always use the
response headers that define a <code>Content-Type</code> and also a <code>Content-Disposition</code>
header.</p>
</div>
<div class="paragraph">
<p>Note that each id has a related HAL-compliant link that can be used to generate a
proper URI based on template variables. The top-level <code>type</code> has, as any other
attribute, a <code>default</code> attribute that is a hint to select what the service consider
to be a good default.</p>
</div>
<div class="paragraph">
<p>The <code>action</code> attribute defines the endpoint the client should contact to actually
generate a project of that type if you can&#8217;t use the HAL-compliant url.</p>
</div>
<div class="paragraph">
<p>The <code>tags</code> object is used to categorize the project type and give <em>hints</em> to 3rd
party client. For instance, the <em>build</em> tag defines the build system the project is
going to use and the <em>format</em> tag defines the format of the generated content (i.e.
here a complete project vs. a build file. Note that the <code>Content-type</code> header of the
reply provides additional metadata).</p>
</div>
</div>
<div class="sect3">
<h4 id="packaging"><a class="anchor" href="#packaging"></a>11.1.3. Packaging</h4>
<div class="paragraph">
<p>The <code>packaging</code> element defines the kind of project that should be generated.</p>
</div>
<div class="listingblock">
<div class="title">Packaging example</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-json" data-lang="json">{
  "id" : "jar",
  "name" : "Jar"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The obvious values for this element are <code>jar</code> and <code>war</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="java-version"><a class="anchor" href="#java-version"></a>11.1.4. Java version</h4>
<div class="paragraph">
<p>The <code>javaVersion</code> element provides a list of possible java versions for the project:</p>
</div>
<div class="listingblock">
<div class="title">Java example</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-json" data-lang="json">{
  "id" : "1.6",
  "name" : "1.6"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="languages"><a class="anchor" href="#languages"></a>11.1.5. Languages</h4>
<div class="paragraph">
<p>The <code>language</code> element provides a list of possible languages for the project:</p>
</div>
<div class="listingblock">
<div class="title">Language example</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-json" data-lang="json">{
  "id" : "groovy",
  "name" : "Groovy"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="platform-versions"><a class="anchor" href="#platform-versions"></a>11.1.6. Platform versions</h4>
<div class="paragraph">
<p>The <code>bootVersion</code> element provides the list of available platform versions</p>
</div>
<div class="listingblock">
<div class="title">Platform versions example</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-json" data-lang="json">{
  "id" : "2.5.0-SNAPSHOT",
  "name" : "Latest SNAPSHOT"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="defaults"><a class="anchor" href="#defaults"></a>11.2. Defaults</h3>
<div class="paragraph">
<p>Each top-level element has a <code>default</code> attribute that should be used as a hint to
provide the default value in the relevant UI component.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-the-stubs"><a class="anchor" href="#using-the-stubs"></a>12. Using the Stubs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Initializr project publishes
<a href="https://github.com/tomakehurst/wiremock">WireMock</a> stubs for all the JSON responses
that are tested in the project. If you are writing a client for Spring Initializr
service, you can use these stubs to test your own code. You can consume them with the
raw Wiremock APIs, or via some features of
<a href="https://github.com/spring-cloud/spring-cloud-contract">Spring Cloud Contract</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
WireMock is an embedded web server that analyses incoming requests and chooses stub
responses based on matching some rules (e.g. a specific header value). So if you send
it a request which matches one of its stubs, it will send you a response as if it was
a real Initializr service, and you can use that to do full stack integration testing
of your client.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="using-wiremock-with-spring-boot"><a class="anchor" href="#using-wiremock-with-spring-boot"></a>12.1. Using WireMock with Spring Boot</h3>
<div class="sect3">
<h4 id="loading-stubs-from-the-classpath"><a class="anchor" href="#loading-stubs-from-the-classpath"></a>12.1.1. Loading Stubs from the Classpath</h4>
<div class="paragraph">
<p>A convenient way to consume the stubs in your project is to add a test dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.spring.initializr&lt;/groupId&gt;
    &lt;artifactId&gt;initializr-web&lt;/artifactId&gt;
    &lt;classifier&gt;stubs&lt;/classifier&gt;
    &lt;version&gt;0.22.0-SNAPSHOT&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>and then pull the stubs from the classpath. In a Spring Boot application, using
Spring Cloud Contract, you can start a WireMock server and register all the stubs
with it, as shown in the following JUnit 5-based example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@SpringBootTest
@AutoConfigureWireMock(port = 0,
    stubs="classpath:META-INF/io.spring.initializr/initializr-web/0.22.0-SNAPSHOT")
class ClientApplicationTests {

    @Value("${wiremock.server.port}")
    private int port;

    ...

}
</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Wiremock features come with Spring Cloud Contract Wiremock:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-contract-wiremock&lt;/artifactId&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
This dependency is managed by the <code>spring-cloud-contract-dependencies</code> BOM.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="using-the-stub-runner"><a class="anchor" href="#using-the-stub-runner"></a>12.1.2. Using the Stub Runner</h4>
<div class="paragraph">
<p>Alternatively you can configure the stub runner to look for the artifact, using a
different Spring Cloud Contract dependency:
<code>spring-cloud-starter-contract-stub-runner</code>. The example below will automatically
download, if necessary, the defined version of the Spring Initializr stubs (so you don&#8217;t need the
stubs declared as a dependency):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-contract-stubrunner&lt;/artifactId&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The test should use <code>@AutoConfigureStubRunner</code> instead, as shown in the following JUnit
5-based example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@SpringBootTest(webEnvironment = WebEnvironment.NONE)
@AutoConfigureStubRunner(
    ids = "io.spring.initializr:initializr-web:0.22.0-SNAPSHOT",
    repositoryRoot = "https://repo.spring.io/0-snapshot")
class ClientApplicationTests {

    @Autowired
    private StubFinder stubFinder;


    ...

}
</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is JUnit 5-based example of a test that retrieves the metadata of the service. The
assertions do not matter much here but it illustrates how you could integrate that in the
test suite of a custom client:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@SpringBootTest(webEnvironment = WebEnvironment.NONE)
@AutoConfigureStubRunner(ids = "io.spring.initializr:initializr-web:${project.version}", stubsMode = StubsMode.LOCAL)
class ClientApplicationTests {

    @Autowired
    private StubFinder stubFinder;

    @Autowired
    private RestTemplate restTemplate;

    @Test
    void testCurrentMetadata() {
        RequestEntity&lt;Void&gt; request = RequestEntity.get(createUri("/"))
            .accept(MediaType.valueOf("application/vnd.initializr.v2.1+json"))
            .build();

        ResponseEntity&lt;String&gt; response = this.restTemplate.exchange(request, String.class);
        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.OK);
        // other assertions here
    }

    private URI createUri(String path) {
        String url = this.stubFinder.findStubUrl("initializr-web").toString();
        return URI.create(url + path);
    }

    @TestConfiguration
    static class Config {

        @Bean
        RestTemplate restTemplate(RestTemplateBuilder builder) {
            return builder.build();
        }

    }

}
</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then you have a server that returns the stub of the JSON metadata
(<code>metadataWithCurrentAcceptHeader.json</code>) when you send it a header
<code>Accept:application/vnd.initializr.v2.2+json</code> (as recommended).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="names-and-paths-of-stubs"><a class="anchor" href="#names-and-paths-of-stubs"></a>12.2. Names and Paths of Stubs</h3>
<div class="paragraph">
<p>The stubs are laid out in a jar file in a form (under "**/mappings") that can be consumed
by WireMock just by setting its file source. The names of the individual stubs are the
same as the method names of the test cases that generated them in Spring Initializr
project. So for example there is a test case "metadataWithV2AcceptHeader" in
<code>MainControllerIntegrationTests</code> that makes assertions about the response when the accept
header is <code>application/vnd.initializr.v2.1+json</code>. The response is recorded in the stub,
and it will match in WireMock if the same headers and request parameters that were used in
Spring Initializr test case and used in the client. The method name usually summarizes what
those values are.</p>
</div>
<div class="paragraph">
<p>The stub runner, and the <code>@AutoConfigureWireMock</code> in the examples above loads all the
stubs into WireMock, so you don&#8217;t necessarily need to know the names of the stubs. You can
also register stubs one by one, though, in which case it would help to scan the stubs jar
and compare the file names with the test methods. For instance, if you look in the stubs
jar, you will see a file called <code>metadataWithV2AcceptHeader.json</code> and, in the
initializr-web project, a test method called <code>metadataWithV2AcceptHeader</code> which generated
it.</p>
</div>
<div class="paragraph text-center">
<p><a href="https://beian.miit.gov.cn/#/Integrated/index">粤ICP备2024234224</a></p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-03-23 04:22:44 UTC
</div>
</div>
<script src="js/highlight/highlight.min.js"></script>
<script>
if (!hljs.initHighlighting.called) {
  hljs.initHighlighting.called = true
  ;[].slice.call(document.querySelectorAll('pre.highlight > code[data-lang]')).forEach(function (el) { hljs.highlightBlock(el) })
}
</script>
</div>
  </div>
</div>
</body>
</html>